{% extends "layout.html" %}

{% block title %}
    Dashboard - Results
{% endblock %}

{% block main %}
    
<h1>ROOM: {{ room[0]['room_name'] }}</h1>
<h6>STATUS: {{ room[0]['status'] }}</h6>
<h6>{{ message }}</h6>
{% if user_voted %}
    <div>
    <h4>This is your Vote!</h4>
        <table class="table">
            <thread>
                <tr>
                    <th scope="col">Option</th>
                    <th scope="col">Vote</th>
                </tr>
            </thread>
            {% for row in user_votes %}
                <tbody>
                    <tr>
                        <th scope="row">{{ row['option_name'] }}</th>
                        <td>{{ row['vote'] }}</td>
                    </tr>
                </tbody>
            {% endfor %}
        </table>
    </div>
{% endif %}

{% if room_close %}
    <div>
    <h4>These are the Room Results!</h4>
        <table class="table">
            <thread>
                <tr>
                    <th scope="col">Option</th>
                    <th scope="col">Vote</th>
                </tr>
            </thread>
            {% for row in room_votes %}
                <tbody>
                    <tr>
                        <th scope="row">{{ row['option_name'] }}</th>
                        <td>{{ row['all_votes'] }}</td>
                    </tr>
                </tbody>
            {% endfor %}
        </table>
        <table class="table">
            <td>
                <center><divv id="piechart"></divv></center>
            </td>
        </table>
    </div>

{% endif %}

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">

// Load Google Charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart on set values
function drawChart() {

    var data = google.visualization.arrayToDataTable({{ chart_list|tojson }});


    var options = {'title':'Vote Results', 'width':550, 'height':400};

    var chart = new google.visualization.PieChart(document.getElementById('piechart'));

    chart.draw(data, options);

}

</script>


{% endblock %}